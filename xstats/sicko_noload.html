<html>
<head>
<title>LOL X-Stats Sicko Mode</title>

<link rel="stylesheet" type="text/css" href="styl.css" />

<meta property="og:title" content="LOL X-Stats Sicko Mode" />
<meta property="og:type" content="website" />
<meta property="og:description" content="How high are you?" />

</head>
<body>
<div id="noscript">
	<p>Oops, you turned off JavaScript<noscript> (or NoScript is getting in the way)</noscript>.</p>
	<p>Challenge again.</p>
</div>
<div id="error" style="display:none">
</div>
<div id="game" style="display:none">
	<p>LOL X-STATS SICKO MODE</p>
	<p>Directions: Simply pick the character who would get more votes on an outdated Internet website.</p>
	<p class="finePrint">I used the unadjusted stats because I have no idea where to find the good ones. Eh I'm sure it'll be fine.</p>
	<p><strong>Everyone in this game is from a three-way or four-way match!</strong></p>
	
	<p>
		<span id="results"></span>
		<br/>
		<span id="streak"></span>
	</p>
	
	<div id="endedGame">
		<p>IT'S OVER!</p>
		<p id="finalResult"></p>
		<p id="bestWin"></p>
		
		<p><input type="button" value="Try Again?" onclick="startStreak()" class="butt" />
	</div>
	
	<p id="activeGame">
		<input type="button" id="topOp" value="Summer 2002 Link" onclick="datTopOption()" class="butt" />
		vs 
		<input type="button" id="bottomOp"value="Summer 2004 Tanner" onclick="bottomOption()" class="butt" />
	</p>
	<div id="contestInfo">
	</div>

	<div id="gameList">
	</div>
</div>
<script type="text/javascript" src="dat.js"></script>
<script type="text/javascript" src="contestHistory.js"></script>
<script type="text/javascript" src="gameList.js"></script>
<script type="text/javascript" src="utility.js"></script>
<script>
	document.getElementById("noscript").style.display = "none"
	document.getElementById("error").style.display = ""
	document.getElementById("error").innerHTML = "argh i tore my JS compiler"
</script>
<script>
	document.getElementById("error").style.display = "none"
	var text = ["ðŸŸ©","ðŸŸ¥","â¬œ"]
	
	var charList = []
	var pointer = 0
	var match = 0
	var correct = 0
	var bestWin = 50
	var inPlay = 0
	
	function startStreak() {
		try {
			charList = []
			pointer = 0
			match = null
			correct = 0
			bestWin = 50
			document.getElementById("bestWin").innerHTML = ""
			
			shuffle()
			initMatch()
			
			document.getElementById("activeGame").style.display = ""
			document.getElementById("endedGame").style.display = "none"
			document.getElementById("results").innerHTML = text[2]
			document.getElementById("streak").innerHTML = "How high can you go?"
		}
		catch( e ) {
			arrowed(e.message)
		}
	}
	
	function shuffle() {
		inPlay = 0
		var used = []
		for( var i = 0; i < datmax; i++ ) {
			charList[i] = -1
			if( 
				 datnm[i].indexOf("Summer 2007") > -1 ||
				 datnm[i].indexOf("Fall 2008") > -1 ||
				 datnm[i].indexOf("Summer 2013") > -1
			) {
				inPlay++
				used[i] = false
			}
			else {
				used[i] = true
			}
		}
		
		// bad shuffling algorithm that is broken and it's just too much work to figure out where i went wrong
		for( var slot = 0; slot < inPlay; slot++ ) {
			var roll = Math.floor(Math.random() * (inPlay - slot))
			while( charList[slot] == -1 ) {
				for( var i = 0; i < datmax; i++ ) {
					if( !used[i] ) {
						if( roll == 0 ) {
							charList[slot] = i
							used[i] = true
							break
						}
						else {
							roll--;
						}
					}
				}
			}
			/*if( charList[slot] == -1 ) {
				arrowed("shuffling algorithm at " + slot)
			}*/
		}
	}

	function initMatch() {
		match = null
		
		var valid = false
		var a;
		var b;
		while( !valid ) {
			if( pointer + 1 >= inPlay ) {
				endGame()
				return
			}
			a = charList[pointer]
			b = charList[pointer + 1]
			pointer += 2
			valid = (datx[a] != datx[b]);
		}
	
		match = {
			"ch1":datnm[a],
			"ch2":datnm[b],
			"x1":datx[a],
			"x2":datx[b],
			"win":(datx[a] - datx[b])
		};
	
		var button = [
			document.getElementById("topOp"),
			document.getElementById("bottomOp")
		]
		var warning = [
			document.getElementById("topWarn"),
			document.getElementById("botWarn")
		]
		button[0].value = match.ch1
		button[1].value = match.ch2
		
		for( var i = 0; i < 2; i++ ) {
			button[i].style.backgroundColor = randomColor()
		}

		contestHistory(match.ch1, match.ch2)
	}
	
	function randomColor() {
		var x = "#"
		for( var i = 0; i < 3; i++ ) {
			var a = Math.floor(Math.random() * 8) + 8
			var b = Math.floor(Math.random() * 16)
			x += a.toString(16) + b.toString(16)
		}
		return x
	}
	
	function vote(option) {
		try {
			var choice = (option < 0)
			var xstats = (match.win < 0)
			
			var resultBox = document.getElementById("results")
			var streakBox = document.getElementById("streak")
			
			if( correct == 0 ) {
				resultBox.innerHTML = ""
			}
			
			if( choice == xstats ) {
				correct++
				bestChoice()
				resultBox.innerHTML += text[0]
				streakBox.innerHTML = correct + " x-stats streak!"
				initMatch()
			}
			else {
				resultBox.innerHTML += text[1]
				streakBox.innerHTML = correct + " x-stats streak"
				endGame()
			}
		}
		catch( e ) {
			arrowed(e.message)
		}
	}
	
	function datTopOption() {
		vote(1);
	}
	
	function bottomOption() {
		vote(-1);
	}
	
	function bestChoice() {
		if( Math.abs(match.win) < bestWin ) {
			bestWin = Math.abs(match.win);
			document.getElementById("bestWin").innerHTML = "Most Impressive Correct Choice:<br/>"
				+ "<span class='fineprint'>aka \"why are these characters this close to each other?\"</span><br/>"
				+ match.ch1 + " (" + match.x1 + "%) <br/>" 
				+ match.ch2 + " (" + match.x2 + "%)"
		}
	}
	
	function endGame() {
		contestHistory()
		document.getElementById("activeGame").style.display = "none"
		document.getElementById("endedGame").style.display = ""
		
		var finalResult = document.getElementById("finalResult")
		if( match == null ) {
			finalResult.innerHTML = "You actually made it to the end?! Good work, Luster."
		}
		else {
			finalResult.innerHTML = "You made the wrong choice on:<br/>" 
				+ match.ch1 + " (" + match.x1 + "%) <br/>" 
				+ match.ch2 + " (" + match.x2 + "%)"
		}
	}
	
	function arrowed(msg) {
		document.getElementById("game").style.display = "none"
		document.getElementById("error").style.display = ""
		document.getElementById("error").innerHTML = "argh i tore my " + msg
	}
	
	startStreak()
	document.getElementById("game").style.display = ""
	runGameList("sicko");
</script>

</body>
</html>