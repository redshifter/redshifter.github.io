<html>
<head>
<title>LOL X-Statsle</title>
<!-- VERSION HISTORY -->

<style>
BODY {
	text-align:center;
	font-size:20px;
	background-color: black;
	color: white;
}

.FINEPRINT {
	font-size:10px;
}

TEXTAREA {
	resize: none;
}

.BUTT {
	font-size:24px
}

</style>

<meta property="og:title" content="LOL X-Statsle" />
<meta property="og:type" content="website" />
<meta property="og:description" content="The daily X-Stats game. Why though?" />

</head>
<body>
<div id="noscript">
	<p>Oops, you turned off JavaScript<noscript> (or NoScript is getting in the way)</noscript>.</p>
	<p>Challenge again.</p>
</div>
<div id="error" style="display:none">
</div>
<div id="game" style="display:none">
	<p>LOL X-STATSLE #<span id="number"></span></p>
	<p id="results"></p>
	<p>Directions: Simply pick the character who would get more votes on an outdated Internet website.</p>
	<p class="finePrint">I used the unadjusted stats because I have no idea where to find the good ones. Eh I'm sure it'll be fine.</p>
	<p id="activeGame">
		<span id="topWarn"></span>
		<input type="button" id="topOp" value="Summer 2002 Link" onclick="datTopOption()" class="butt" />
		vs 
		<input type="button" id="bottomOp"value="Summer 2004 Tanner" onclick="bottomOption()" class="butt" />
		<span id="botWarn"></span>
	</p>
	
	<div id="endedGame" style="display:none">
		<p>You got <span id="correct"></span> of 6 right. <span id="funnySaying"></span></p>
		<textarea id="shareable" readonly="true" cols="30" rows="4">#lolXStats #1\r\nLine 2</textarea>
	</div>
	<div style="display:none">
		<p id="Summer2002">The Summer 2002 GameFAQs Contest, The Great GameFAQs Character Battle.</p>
		<p id="Summer2003">The Summer 2003 GameFAQs Contest, CBII.</p>
		<p id="Summer2004">The Summer 2004 GameFAQs Contest, CBIII.</p>
		<p id="Spring2005">The Spring 2005 GameFAQs Contest, Got Villains?</p>
		<p id="Summer2005">The Summer 2005 GameFAQs Contest, CBIV.</p>
		<!--
		<p id="Summer2006">The Summer 2006 GameFAQs Contest, CBV. This had a male and female bracket. Where are the x-stats for this?</p> 
		<p id="Summer2007">The Summer 2006 GameFAQs Contest, CBVI. FATAL 4 WAY</p>
		<p id="Fall2008">The Fall 2008 GameFAQs Contest, CBVII. FATAL 4 WAY</p>
		-->
		<p id="Winter2010">The Winter 2010 GameFAQs Contest, CBVIII.</p>
		<p id="Summer2013">The Summer 2013 GameFAQs Contest, CBIX. TRIPLE THREAT</p> <!-- do we really even want this one? -->
		<p id="Summer2018">The Summer 2018 GameFAQs Contest, CBX. DOUBLE BATTLES</p>
	</div>
	<div>
		<br/>
		<br/>
		<p>Play a different game?</p>
		<p>
			<input type="input" id="arbitrary" style="width:60px" />
			<input type="button" value="Play Game" onclick="generateGame(document.getElementById('arbitrary').value)" />
		</p>
	</div>
	<div>
		<p>Other Modes?</p>
		<p><a href="streak.html">Winning Streak!</a></p>
	</div>
</div>
<script type="text/javascript" src="dat.js"></script>
<script>
	document.getElementById("noscript").style.display = "none"
	document.getElementById("error").style.display = ""
	document.getElementById("error").innerHTML = "argh i tore my JS compiler"
</script>
<script>
	document.getElementById("error").style.display = "none"
	var text = ["ðŸŸ©","ðŸŸ¥","â¬œ"]
	
	var gameNumber = 0
	var match = 0
	var matches = []
	var correct = 0
	
	function getCurrentDay() {
		var startYear = 2025
		var startMonth = 8 - 1
		var startDay = 30
		
		var day = 1
		var d = new Date()
		
		var terminus = Date.UTC(startYear, startMonth, startDay);
		var today = Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate());
		
		if( today < terminus ) {
			arrowed("system clock")
			return 0
		}
		while( today > terminus ) {
			terminus = Date.UTC(startYear, startMonth, startDay + day);
			day += 1
		}
		
		return day
	}
	
	function generateToday() {
		try {
			var day = getCurrentDay();
			document.getElementById("arbitrary").value = day
			generateGame(day)
		}
		catch( e ) {
			arrowed(e.message)
		}
	}
	

	function generateGame(number) {
		try {
			document.getElementById("activeGame").style.display = ""
			document.getElementById("endedGame").style.display = "none"
			
			matches = []
			correct = 0
			match = 0
			
			gameNumber = number
			document.getElementById("number").innerHTML = number
			seedRandom(number);
			
			// make results
			var results = document.getElementById("results")
			results.innerHTML = ""
			for( var i = 0; i < 6; i++ ) {
				results.innerHTML += "<span id='r" + i + "'>" + text[2] + "</span> "
			}
			
			// start pulling things
			//var gen = sampleData();
			var gen = generateData();
			matches = sortData(gen)
			
			// start the game
			document.getElementById("game").style.display = ""
			match = 0
			initMatch()
		}
		catch( e ) {
			arrowed(e.message)
		}
	}
	
	function initMatch() {
		var button = [
			document.getElementById("topOp"),
			document.getElementById("bottomOp")
		]
		var warning = [
			document.getElementById("topWarn"),
			document.getElementById("botWarn")
		]
		button[0].value = matches[match].ch1
		button[1].value = matches[match].ch2
		
		for( var i = 0; i < 2; i++ ) {
			button[i].style.backgroundColor = randomColor()
			/*
			if( button[i].value.indexOf("Summer 2013") > -1 ) {
				warning[i].innerHTML = "THREE-WAY X-STATS"
			}
			else {
				warning[i].innerHTML = ""
			}
			*/
		}
	}
	
	function randomColor() {
		var x = "#"
		for( var i = 0; i < 3; i++ ) {
			var a = Math.floor(random() * 8) + 8
			var b = Math.floor(random() * 16)
			x += a.toString(16) + b.toString(16)
		}
		return x
	}
	
	function vote(option) {
		try {
			var choice = (option < 0)
			var xstats = (matches[match].win < 0)
			
			var resultBox = document.getElementById("r" + match)
			
			if( choice == xstats ) {
				resultBox.innerHTML = text[0]
				correct++
			}
			else {
				resultBox.innerHTML = text[1]
			}
			resultBox.innerHTML += " "
			
			match++
			if( match < 6 ) {
				initMatch(match)
			}
			else {
				endGame()
			}
		}
		catch( e ) {
			arrowed(e.message)
		}
	}
	
	function datTopOption() {
		vote(1);
	}
	
	function bottomOption() {
		vote(-1);
	}
	
	function endGame() {
		if( correct < 6 ) {
			document.getElementById("funnySaying").innerHTML = "you tore your [quad]"
		}
		else {
			document.getElementById("funnySaying").innerHTML = "you got them all!"
		}
		document.getElementById("correct").innerHTML = correct
		
		var shareable = document.getElementById("shareable");
		shareable.value = "#lolXStats #" + gameNumber + "\n";
		for( var i = 0; i < 6; i++ ) {
			shareable.value += document.getElementById("r" + i).innerHTML
		}
		
		document.getElementById("activeGame").style.display = "none"
		document.getElementById("endedGame").style.display = ""
	}
	
	var rand = 0.0;
	function seedRandom(seed) {
		rand = +seed + 42069.0
		if( rand == 0 ) rand = 1 // ????
		for( var i = 0; i < 12; i++ ) random() // seed it a few times
	}
	function random() {
		var val = (Math.sin(rand) + 1.0) / 2.0;
		rand = (rand * 16807) % 2146483647;
		return val
	}

	function arrowed(msg) {
		document.getElementById("game").style.display = "none"
		document.getElementById("error").style.display = ""
		document.getElementById("error").innerHTML = "argh i tore my " + msg
	}
	
	function generateData() {
		var gen = []
		for( var i = 0; i < 6; i++ ) {
			var obj = null
			var a = Math.floor(random() * datmax)
			var b = Math.floor(random() * datmax)
			
			if( a != b && datx[a] != datx[b] ) {
				obj = {
					"ch1":datnm[a],
					"ch2":datnm[b],
					"x1":datx[a],
					"x2":datx[b],
					"win":(datx[a] - datx[b])
				};
			
				var val = Math.abs(datx[a] - datx[b])
				for ( var j = 0; j < i; j++ ) {
					if( Math.abs(gen[j].win) == val ) {
						obj = null
					}
				}
			}
			
			if( obj == null ) {
				i--;
			}
			else {
				gen[i] = obj
			}
		}
		
		return gen
	}
	
	function sampleData() {
		// TODO make sure there's no ties in the real method
		// also make sure none of the samples match ABS
		var gen = []
		gen[0] = {
			"ch1":"Fall 2018 Alucard",
			"ch2":"Summer 2005 CATS",
			"x1":31.27,
			"x2":17.63,
			"win":13.64
		}
		gen[1] = {
			"ch1":"Summer 2004 Vivi Ornitier",
			"ch2":"Fall 2018 Luigi",
			"x1":25.23,
			"x2":27.77,
			"win":-2.54
		}
		gen[2] = {
			"ch1":"Summer 2013 Raz",
			"ch2":"Summer 2013 Squirtle",
			"x1":8.03,
			"x2":25.07,
			"win":-17.04
		}
		gen[3] = {
			"ch1":"Summer 2002 Servbot",
			"ch2":"Spring 2005 Ghaleon",
			"x1":19.40,
			"x2":15.07,
			"win":4.33
		}
		gen[4] = {
			"ch1":"Winter 2010 Fox McCloud",
			"ch2":"Spring 2005 Giygas",
			"x1":29.36,
			"x2":12.57,
			"win":16.79
		}
		gen[5] = {
			"ch1":"Winter 2010 Commander Shepard",
			"ch2":"Summer 2013 Kain",
			"win":21.63
		}
		return gen;
	}
	function sortData(gen) {
		var sortGen = [0,0,0,0,0,0]
		
		// i could do a good sorting algorithm but i'm bored
		// this will put the easiest at the start, the hardest at the end, and keep the random order decided for the others
		var minv = 50
		var maxv = 0
		for( var i = 0; i < gen.length; i++ ) {
			var v = Math.abs(gen[i].win);
			if( v < minv ) minv = v
			if( v > maxv ) maxv = v
		}
		var j = 1
		for( var i = 0; i < gen.length; i++ ) {
			var v = Math.abs(gen[i].win);
			if( v == maxv ) sortGen[0] = gen[i]
			else if( v == minv ) sortGen[5] = gen[i]
			else {
				sortGen[j] = gen[i]
				j++
			}
		}
		
		return sortGen;
	}

	generateToday();
	
</script>

</body>
</html>